{"version":3,"sources":["modules/basicAuth/BasicAuth.module.ts","modules/utils/LPUtils.module.ts","modules/basicAuth/contentscript/basicAuthFrame.ts"],"names":[],"mappings":"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","file":"modules-contentscript.js","sourcesContent":["// Shared definitions, objects and methods can be added here.\n","module LPUtils {\n    export function stringContains(str: string, checks: string | Array<string>) {\n        if (str && checks) {\n            if (!Array.isArray(checks)) {\n                checks = [checks];\n            }\n            for (let i = 0; i < checks.length; ++i) {\n                if (str.indexOf(checks[i]) > -1) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    }\n}","module lastpass {\n    export class BasicAuthContentScript {\n\n        constructor() {\n            let that = this;\n            bg.basicAuth.hasFeature((hasFeature) => {\n                if (hasFeature) {\n                    bg.basicAuth.isBasicAuth((isBasicAuth, suppliedBefore) => that.init(isBasicAuth, suppliedBefore));\n                }\n            });\n        }\n\n        private backgroundInterface: BackgroundInterface;\n\n        private init(isBasicAuth: boolean, suppliedBefore: boolean) {\n            if (!isBasicAuth) {\n                return;\n            }\n            this.backgroundInterface = bg;\n            this.loadContent(() => {\n                this.initContent(suppliedBefore);\n            });\n        }\n\n        private loadContent(callback: () => void) {\n            $.get(chrome.runtime.getURL('/basicAuth/views/basicAuthFrame.html'), (response) => {\n                let content = this.replaceRelativePaths(response);\n                $(document.body).empty().append(content);\n                callback();\n            });\n        }\n\n        private initContent(suppliedBefore: boolean) {\n            let inputField = $('#ba_username');\n            inputField.focus();\n\n            if (!suppliedBefore) {\n                $('#wronguserpass').hide();\n            }\n            document.title = 'Lastpass basic auth login';\n            $('#title').text(location.host);\n            if (location.protocol === 'http:') {\n                $('#secureWarning').show()\n            } else {\n                $('#secureWarning').hide()\n            }\n            this.subscribeEvents();\n            this.openPopupNotification();\n            this.backgroundInterface.sendLpImprove('basicauth::triggered');\n        }\n\n        private subscribeEvents() {\n            $('#lp-login-btn').click(() => {\n                $('.js-notification').toggle('notification-visible');\n                this.doLogin();\n            });\n            $('#password').keypress((event) => {\n                if (event.which == 13) {\n                    this.doLogin();\n                }\n            });\n\n            $('#lp-cancel-btn').click(() => {\n                this.cancelBasicAuth();\n                this.backgroundInterface.sendLpImprove('basicauth::cancel');\n            });\n\n            $('.notification__close__button').click(() => {\n                $('.notification__body').removeClass('slide-in').addClass('slide-out');\n                this.backgroundInterface.basicAuth.closeNotification();\n            });\n        }\n\n        private doLogin() {\n            let username = $('#ba_username').val();\n            let password = $('#ba_password').val();\n            this.backgroundInterface.sendLpImprove('basicauth::login');\n            this.backgroundInterface.basicAuth.setAuthCredential(username, password, () => location.reload());\n        }\n\n        private cancelBasicAuth() {\n            this.backgroundInterface.basicAuth.cancelBasicAuth();\n            $('#login-body').hide();\n            location.reload();\n        }\n\n        private replaceRelativePaths(htmlContent: string): string {\n            let url = chrome.runtime.getURL('');\n            return htmlContent.replace(new RegExp('{extensionUrl}', 'g'), url);\n        }\n\n        private openPopupNotification() {\n            this.backgroundInterface.basicAuth.isNotificationClosed((isClosed) => {\n                if (isClosed) {\n                    $('.notification__body').hide();\n                }\n                else {\n                    $('.notification__body').addClass('slide-in');\n                }\n            });\n        }\n    }\n}\n\n// Backwards compatibility\nthis.basicAuth = new lastpass.BasicAuthContentScript();\n"]}