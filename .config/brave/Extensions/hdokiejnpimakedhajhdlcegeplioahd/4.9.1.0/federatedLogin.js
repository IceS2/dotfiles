var FederatedLogin=function(){var e={};return{initiateFederatedLogin:function(e,r,o){if(!a(e))return;t(e,function(t){var a,i,s,u=n(t.type);o(u),u&&(a=t.IdentityProviderURL,i=t.IdentityProviderGUID,s=function(a){var n,o,i;n=a,o=t.IdentityProviderURL,i=function(t){var a,n,o,i,s;a=e,n=t,o=function(a){var n,o;LP_do_login(e,(n=t,o=a,btoa(binarySHA256(XOR(XOR(atob(n.k1),atob(n.k2)),atob(o))))),r)},i=XOR(atob(n.k1),atob(n.k2)),s=btoa(binarySHA256(i)),LPServer.lmiapi.jsonRequest({url:"lmiapi/login/getLocalKeyPart",type:"POST",data:{username:a,keyHash:s,authSessionId:n.authSessionId},success:function(e){o(e.localKey)},error:function(e){console.error(e)}})},LPServer.jsonRequest({baseUrl:o,url:"/auth/saml2/getauthinfo/"+n,type:"GET",success:function(e){i(e)},error:function(e){console.error(e)}})},LPPlatform.openTab({url:a+"/auth/saml2/"+i,loadHandler:function(e){var t={},a=e.tabDetails.tabID,n=LPPlatform.onTabUpdated(function(e){if(a===e.tabDetails.tabID){if(t[e.tabDetails.tabID]!==e.tabDetails.tabURL&&-1!==e.tabDetails.tabURL.indexOf("/auth/saml2/success/")){var r=e.tabDetails.tabURL.substring(e.tabDetails.tabURL.length-67);e.close(),n(),s(r)}t[e.tabDetails.tabID]=e.tabDetails.tabURL}})}}))})},isUserFederated:function(r,o){a(r)?e[r]?o(n(e[r].type)):t(r,function(t){e[r]=t,o(n(t.type))}):o(!1)}};function t(e,t){var a,n=Preferences.get(e);n&&(a=JSON.parse(n)),a&&a.queryDate>Date.now()-6e4?t(a):LPServer.jsonRequest({url:"lmiapi/login/type",CSRFToken:!1,type:"GET",data:{username:e},success:function(a){a.queryDate=Date.now(),Preferences.set(e,JSON.stringify(a)),t(a)},error:function(e){console.error(e)}})}function a(e){return void 0!==e&&""!==e&&null!==check_email(e)}function n(e){return 0!==e}}();
//# sourceMappingURL=sourcemaps/federatedLogin.js.map
